(function(n){"use strict";var t=function(t,i){this.options=n.extend({},n.fn.letterfx.defaults,i);this.num_completed_fx=0;this.is_done=!1;this.monitor_timer=null;this.killswitch=null;this.$element=n(t);this.options.restore&&(this.original_html=this.$element.html());this.init()},i;t.prototype.init=function(){return this.new_html=this.$element.text().replace(this.options.pattern,this.options.replacement),this.$element.addClass(this.options.css.element.base).addClass(this.options.css.element.before),this.$element.html(this.new_html),this.$letters=this.$element.find(this.options.selector),this.$letters.css("transition-duration",this.options.fx_duration).addClass(this.options.css.letters.base).addClass(this.options.css.letters.before),this.bindLetterFxEnd(),this.num_letters=this.$letters.length,this.fx(),this};t.prototype.bindLetterFxEnd=function(){var t=this.options,i=this;return this.$letters.bind("transitionend",function(){t.onLetterComplete(n(this),i.$element,i);i.notifyFXEnd();switch(t.letter_end){case"destroy":n(this).remove();break;case"rewind":i.applyLetterFx(n(this),t.timing,t.css.letters.after,t.css.letters.before);break;case"stay":break;default:n(this).replaceWith(n(this).text())}}),i};t.prototype.terminate=function(){this.is_done=!0;this.options.onElementComplete(this.$element,this);clearTimeout(this.killswitch);switch(this.options.element_end){case"destroy":this.$element.remove();break;case"stay":break;default:this.$element.html(this.original_html);this.$element.removeClass(this.options.css.element.base).removeClass(this.options.css.element.after)}};t.prototype.notifyFXEnd=function(){clearTimeout(this.monitor_timer);this.num_completed_fx++;var n=this;return this.monitor_timer=setTimeout(function(){n.num_completed_fx%n.num_letters==0&&n.terminate()},Math.max(this.options.timing+10,50)),this};t.prototype.startKillWatch=function(){var t=this.options.fx_duration.match(/\d+s/)?parseInt(this.options.fx_duration):1,i=Math.ceil(1.5*this.num_letters*this.options.timing*t),n=this;this.killswitch=window.setTimeout(function(){n.isDone()||n.terminate()},i)};t.prototype.fx=function(){var r=this,i,t;return this.startKillWatch(),this.$element.removeClass(this.options.css.element.before).addClass(this.options.css.element.after),i=this.options.sort(this.$letters),t=this.options,i.each(function(i,u){r.applyLetterFx(n(u),(i+1)*t.timing,t.css.letters.before,t.css.letters.after)}),this};t.prototype.applyLetterFx=function(n,t,i,r){var u=this.options;return window.setTimeout(function(){n.removeClass(i).addClass(r)},t),this};t.prototype.isDone=function(){return this.is_done};i=function(t){this.config=n.extend({},n.fn.letterfx.defaults,t);this.buildCss(this.config.backwards);this.config.words&&(this.config.pattern=/(\S+)/g)};i.prototype.buildCss=function(t){var i=this.config,u=t?"after":"before",f=t?"before":"after",r={element:{},letters:{}};r.element.base=i.element_class+"-container "+i.fx.replace(/(\S+)/g,i.element_class+"-$1-container");r.element[u]=i.fx.replace(/(\S+)/g,i.element_class+"-$1-before-container");r.element[f]=i.fx.replace(/(\S+)/g,i.element_class+"-$1-after-container");r.letters.base=i.element_class;r.letters[u]=i.fx.replace(/(\S+)/g,i.element_class+"-$1-before");r.letters[f]=i.fx.replace(/(\S+)/g,i.element_class+"-$1-after");this.config=n.extend(i,{css:r})};i.prototype.getConfig=function(){return this.config};i.parse=function(n){return new i(n).getConfig()};n.fn.letterfx=function(r){return r=i.parse(r),n(this).each(function(){var i=n(this);(!i.data("letterfx-obj")||i.data("letterfx-obj").isDone())&&i.data("letterfx-obj",new t(i,r))})};n.fn.letterfx.sort={random:function(n){for(var t=n.length,r,i;0!==t;)i=Math.floor(Math.random()*t),t-=1,r=n[t],n[t]=n[i],n[i]=r;return n},reverse:function(n){return n.toArray().reverse()}};n.fn.letterfx.patterns={letters:/(\S)/gi};n.fn.letterfx.defaults={fx:"spin fly-top",pattern:/(\S)/gi,word:!1,backwards:!1,replacement:"<span>$1<\/span>",selector:"span",timing:50,fx_duration:"1s",sort:function(n){return n},onLetterComplete:function(){},onElementComplete:function(){},letter_end:"restore",element_end:"restore",restore:!0,destroy:!1,element_class:"letterfx",css:{element:{base:"",before:"",after:""},letters:{base:"",before:"",after:""}}}})(jQuery);
//# sourceMappingURL=jquery-letterfx.min.js.map
